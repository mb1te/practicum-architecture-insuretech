#  Технологическая архитектура TO-BE

1. Стратегия масштабирования и отказоустойчивости

- Для приложений настроен HPA для автоматического масштабирования подов
- Три зоны доступности для достижения 99.9% SLA при падении одной из зон 
- Вертикальное масштабирование применимо только для кластера Postgres

2a. Конфигурация развёртывания приложения в Kubernetes

Независимые кластеры Kubernetes

- Падение кластера не влияет на другие зоны доступности
- Независимое обновление зон доступности
- Нет сложностей с etcd синхронизацией

2b. Балансировка нагрузки

- Global Server Load Balancer для геобалансировки, делает healthcheck к Application Load Balancer в зонах доступности
- Application Load Balancer делает healthcheck к подам приложений

2c. Фейловер-стратегия

- Падение 1 зоны доступности: GSLB перераспределяет трафик 50/50
- Падение 2 зон доступности: GSLB направляет весь трафик в 3 зону
- Падение зоны доступности с мастером Postgres: Patroni переключает мастер на живую реплику

2d. Конфигурация базы данных

- Используется Patroni с автоматическим фейловером
- В одной из зон доступности будет мастер, в оставшихся двух синхронные реплики
- При недоступности мастера Patroni переключает мастер на живую реплику
- Бэкап: полный ежедневно + непрерывная WAL-архивация в Object Storage

3. Шардирование БД
Для 50 GB данных нет необходимости делать шардирование
